local lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Timka-q1t-1/Test/refs/heads/main/Library2"))()
local player = game:GetService('Players').LocalPlayer

local hub = lib.Hub('ðŸ€Fling Things and People')
local fat = hub.Section('ðŸ’')
local all = hub.Section('ðŸ©¸ALL')

local function checkDistance(pos1, pos2)
    if type(pos1) == 'vector' and type(pos2) == 'vector' then
        return (pos1 - pos2).Magnitude
        else
            return math.huge
    end
end

local function CheckItem(name)
    local toysFolder = workspace:FindFirstChild(player.Name.."SpawnedInToys")
    if not toysFolder then return false end
    
    for _, item in pairs(toysFolder:GetChildren()) do
        if item.Name == name then
            return item
        end
    end
    return false
end

local function CheckOwn(model)
    if model and model.Parent then
        for _, own in pairs(model:GetDescendants()) do
            if own:IsA("StringValue") and own.Name == "PartOwner" and own.Value == player.Name then
                return true
            end
        end
    end
    return false
end

local function findItems(name)
    local names = {}
    local getList = {}
    for _, item in pairs(workspace:GetDescendants()) do 
        if item:IsA('Model') and item.Name == name then
            table.insert(getList, item)
        end
    end
    return getList
end

local holes = {}
local initHoles = false
local function getHoles() 
    if #holes > 0 and initHoles then return holes end
    local map = workspace:FindFirstChild('Map')

    if map then
        for _, hole in pairs(map:GetDescendants()) do
            if hole:IsA('Part') and hole.Name == 'PoisonHurtPart' then
                table.insert(holes, hole)
            end
        end
        initHoles = true
    end
    return holes
end

local function checkHole()
    if not player.Character then return end

    local currentHoles = getHoles()
    if #currentHoles == 0 then
        task.delay(5, function()
            holesInitialized = false
        end)
        return
    end

    for _, plr in pairs(game:GetService('Players'):GetPlayers()) do
        if plr ~= player and plr.Character and plr.Character:FindFirstChild('HumanoidRootPart') then 
            for _, hole in pairs(currentHoles) do
                if checkDistance(plr.Character:FindFirstChild('HumanoidRootPart').Position, hole.Position) < 35 then
                    last = player.Character:GetPivot()
                    task.wait()
                    while checkDistance(plr.Character:FindFirstChild('HumanoidRootPart').Position, hole.Position) < 35 do
                        if not CheckOwn(plr.Character) then
                            player.Character:MoveTo(plr.Character:GetPivot().Position)
                            local args = {
                                [1] = plr.Character.HumanoidRootPart,
                                [2] = plr.Character.HumanoidRootPart.CFrame
                            }

                            game:GetService("ReplicatedStorage").GrabEvents.SetNetworkOwner:FireServer(unpack(args))
                        else
                            break
                        end
                        task.wait()
                    end
                    plr.Character:MoveTo(Vector3.new(81, 325, 32.5))
                    player.Character:MoveTo(last.Position)
                    task.wait()
                    local args = {
                        [1] = plr.Character.HumanoidRootPart
                    }

                    game:GetService("ReplicatedStorage").GrabEvents.DestroyGrabLine:FireServer(unpack(args))
                    break
                end
            end
        end
    end
end

local function antiBomb()
    if not player.Character then return end
    local getItems = findItems('BombMissile')
    if #getItems == 0 then return end
    for _, plr in pairs(game:GetService('Players'):GetPlayers()) do
        if plr.Character and plr.Character:FindFirstChild('HumanoidRootPart') then 
            for _, bomb in pairs(getItems) do 
                local distance = checkDistance(plr.Character.HumanoidRootPart.Position, bomb:GetPivot().Position)
                if distance < 25 then
                    last = player.Character:GetPivot()
                    task.wait()
                    while bomb and bomb.Parent do
                        if not CheckOwn(bomb) then
                            player.Character:MoveTo(bomb:GetPivot().Position)
                            local args = {
                                [1] = bomb.Body,
                                [2] = bomb.Body.CFrame
                            }

                            game:GetService("ReplicatedStorage").GrabEvents.SetNetworkOwner:FireServer(unpack(args))
                        else
                            local args = {
                                [1] = {
                                    ["Radius"] = 9999,
                                    ["TimeLength"] = 9999,
                                    ["Hitbox"] = bomb.PartHitDetector,
                                    ["ExplodesByFire"] = true,
                                    ["MaxForcePerStudSquared"] = 9999,
                                    ["DestroysModel"] = true,
                                    ["Model"] = bomb,
                                    ["ExplodesByPointy"] = true,
                                    ["ImpactSpeed"] = 9999,
                                    ["PositionPart"] = workspace.Map.TrainTunnel.Mountain1.Rock
                                },
                                [2] = Vector3.new(0, 0, 0)
                            }

                            game:GetService("ReplicatedStorage").BombEvents.BombExplode:FireServer(unpack(args))
                            break
                        end
                        task.wait()
                    end
                    player.Character:MoveTo(last.Position)
                end
            end
        end
    end
end

local function antiGrab()
    if not player.Character then return end

    for _, plr in pairs(game:GetService('Players'):GetPlayers()) do 
        if plr ~= player and plr.Character and plr.Character:FindFirstChild('GrabParts') then 
            local grabParts = plr.Character.GrabParts
            local getGrab = grabParts.GrabPart.WeldConstraint.Part1
            if getGrab.Parent:FindFirstChildOfClass('Humanoid') then 
                local currentPlr = game:GetService('Players'):GetPlayerFromCharacter(getGrab.Parent)
                if currentPlr then 
                    last = player.Character:GetPivot()
                    task.wait()
                    while grabParts and grabParts.Parent do
                        if not CheckOwn(currentPlr.Character) then
                            player.Character:MoveTo(currentPlr.Character:GetPivot().Position)
                            local args = {
                                [1] = currentPlr.Character.HumanoidRootPart,
                                [2] = currentPlr.Character.HumanoidRootPart.CFrame
                            }

                            game:GetService("ReplicatedStorage").GrabEvents.SetNetworkOwner:FireServer(unpack(args))
                        else
                            break
                        end
                        task.wait()
                    end
                    currentPlr.Character:MoveTo(Vector3.new(81, 325, 32.5))
                    player.Character:MoveTo(last.Position)
                    task.wait()
                    local args = {
                        [1] = currentPlr.Character.HumanoidRootPart
                    }

                    game:GetService("ReplicatedStorage").GrabEvents.DestroyGrabLine:FireServer(unpack(args))
                end
            end
        end
    end
end

local function checkFire()
    if not player.Character then return end
    
    for _, plr in pairs(game:GetService("Players"):GetPlayers()) do
        if plr.Character and plr.Character:FindFirstChild('HumanoidRootPart') then
            local hum = plr.Character:FindFirstChild("Humanoid")
            if hum and hum.FireDebounce.Value then
                local antiFire = CheckItem("FireExtinguisher")
                if antiFire then
                    if CheckOwn(antiFire) then
                        antiFire:MoveTo(plr.Character:GetPivot().Position)
                    else
                        local distance = (antiFire:GetPivot().Position - player.Character:GetPivot().Position).Magnitude
                        if distance < 15 then
                            local args = {
                                [1] = antiFire.SoundPart,
                                [2] = antiFire:GetPivot()
                            }
                            game:GetService("ReplicatedStorage").GrabEvents.SetNetworkOwner:FireServer(unpack(args))
                        else
                            local args = {
                                [1] = antiFire
                            }
                            game:GetService("ReplicatedStorage").MenuToys.DestroyToy:FireServer(unpack(args))
                        end
                    end
                else
                    local args = {
                        [1] = "FireExtinguisher",
                        [2] = player.Character:GetPivot(),
                        [3] = Vector3.new(0, 0, 0)
                    }
                    
                    game:GetService("ReplicatedStorage").MenuToys.SpawnToyRemoteFunction:InvokeServer(unpack(args))
                    task.wait(0.2)
                    local newFire = CheckItem("FireExtinguisher")
                    if newFire and newFire:FindFirstChild("SoundPart") then
                        local args = {
                            [1] = newFire.SoundPart,
                            [2] = newFire.SoundPart.CFrame
                        }
                        game:GetService("ReplicatedStorage").GrabEvents.SetNetworkOwner:FireServer(unpack(args))
                    end
                    antiFire:MoveTo(Vector3.new(555, -7.5, -58))
                end
            end
        end
    end
end

local isFire = false
all.Toggle("ÐÐ½Ñ‚Ð¸-Ð¿Ð¾Ð´Ð¶Ñ‘Ð³", function(state)
    task.spawn(function()
        if not isFire then
            isFire = true
            local success, errorMsg = pcall(function()
                checkFire()
            end)    
            if not success then
                warn("ÐžÑˆÐ¸Ð±ÐºÐ° Ð² isFire:", errorMsg)
            end
            task.wait(0.01)
            isFire = false
        end
    end)
end)

local isHole = false
all.Toggle("ÐÐ½Ñ‚Ð¸-Ð¾Ñ‚Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ", function(state)
    task.spawn(function()
        if not isHole then
            isHole = true
            local success, errorMsg = pcall(function()
                checkHole()
            end)    
            if not success then
                warn("ÐžÑˆÐ¸Ð±ÐºÐ° Ð² isHole:", errorMsg)
            end
            task.wait(0.01)
            isHole = false
        end
    end)
end)

local isGrab = false
all.Toggle("ÐÐ½Ñ‚Ð¸-Ð³Ñ€Ð°Ð±", function(state)
    task.spawn(function()
        if not isGrab then
            isGrab = true
            local success, errorMsg = pcall(function()
                antiGrab()
            end)    
            if not success then
                warn("ÐžÑˆÐ¸Ð±ÐºÐ° Ð² isGrab:", errorMsg)
            end
            task.wait(0.02)
            isGrab = false
        end
    end)
end)

local isBomb = false
all.Toggle("ÐÐ½Ñ‚Ð¸-Ð±Ð¾Ð¼Ð±Ð°", function(state)
    task.spawn(function()
        if not isBomb then
            isBomb = true
            local success, errorMsg = pcall(function()
                antiBomb()
            end)    
            if not success then
                warn("ÐžÑˆÐ¸Ð±ÐºÐ° Ð² isBomb:", errorMsg)
            end
            task.wait(0.05)
            isBomb = false
        end
    end)
end)
